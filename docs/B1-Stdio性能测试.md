# B1-Stdio性能测试报告

## 测试环境

| 项目 | 配置 |
|------|------|
| CPU | Apple M4 |
| CPU核心数 | 10 |
| 内存 | 24 GB |
| 操作系统 | macOS 15.7.3 |
| 编译器 | Apple clang 17.0.0 |
| 测试日期 | 2026-01-29 |

## 测试方法

通过标准输入输出管道向MCP服务器发送JSON-RPC请求，测量请求处理性能。

### 测试场景

1. **Ping请求测试**：发送简单的ping请求，测试基础通信性能
2. **工具调用测试**：调用add工具进行计算，测试业务处理性能

## 测试结果

### Ping请求性能

| 请求规模 | 平均耗时 | QPS | 平均延迟 |
|----------|----------|-----|----------|
| 100请求 | 0.0276s | 3,622 | 0.276ms |
| 1000请求 | 0.0434s | 23,049 | 0.043ms |
| 5000请求 | 0.1049s | 47,687 | 0.021ms |

### 工具调用性能

| 测试项 | 请求数 | 总耗时 | QPS |
|--------|--------|--------|-----|
| add工具调用 | 1000 | 0.0622s | 16,079 |

## 性能分析

### 吞吐量特点

1. **高吞吐量**：在大规模请求下，QPS可达47,000+
2. **线性扩展**：随着请求数增加，QPS呈上升趋势（批处理效应）
3. **低延迟**：单请求平均延迟在0.02-0.28ms之间

### 性能瓶颈

1. **I/O开销**：小规模请求时，进程启动和I/O初始化占比较大
2. **JSON解析**：JSON序列化/反序列化是主要CPU开销
3. **工具执行**：工具调用比简单ping慢约30%，因为需要执行业务逻辑

## 优化建议

1. **批量请求**：尽量批量发送请求以提高吞吐量
2. **连接复用**：保持长连接避免重复建立连接
3. **异步处理**：对于耗时工具，考虑异步执行

## 结论

Stdio传输协议在本测试环境下表现优异：
- 峰值QPS：**47,687**
- 最低延迟：**0.021ms**
- 工具调用QPS：**16,079**

适用于本地进程间通信场景，特别是需要高吞吐量、低延迟的应用。
