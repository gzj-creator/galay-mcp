# B2-HTTP性能测试报告

## 测试环境

| 项目 | 配置 |
|------|------|
| CPU | Apple M4 |
| CPU核心数 | 10 |
| 内存 | 24 GB |
| 操作系统 | macOS 15.7.3 |
| 编译器 | Apple clang 17.0.0 |
| IO调度器数 | 20 |
| 计算调度器数 | 10 |
| 测试日期 | 2026-01-29 |

## 测试方法

使用curl并行请求向HTTP MCP服务器发送JSON-RPC请求，测量不同并发级别下的性能表现。

### 测试场景

1. **单连接测试**：串行发送请求，测试基础延迟
2. **10并发测试**：模拟轻量级并发场景
3. **50并发测试**：模拟中等并发场景

## 测试结果

### Ping请求性能

| 测试场景 | 请求数 | 并发数 | 总耗时 | QPS | 平均延迟 |
|----------|--------|--------|--------|-----|----------|
| 单连接 | 100 | 1 | 2.604s | 38.40 | 26.04ms |
| 10并发 | 500 | 10 | 1.296s | 385.80 | 2.59ms |
| 50并发 | 1000 | 50 | 1.508s | 663.00 | 1.51ms |

### 性能特点

1. **并发效果明显**：从单连接到50并发，QPS提升约17倍
2. **延迟降低**：并发情况下平均延迟从26ms降至1.5ms
3. **稳定性好**：高并发下服务器保持稳定响应

## 性能分析

### 吞吐量特点

1. **网络开销**：HTTP协议相比Stdio有额外的TCP连接和协议解析开销
2. **并发优势**：异步IO模型在高并发下表现优异
3. **连接复用**：每个请求建立新连接，存在优化空间

### 与Stdio对比

| 指标 | Stdio | HTTP | 说明 |
|------|-------|------|------|
| 峰值QPS | 47,687 | 663 | Stdio无网络开销 |
| 最低延迟 | 0.021ms | 1.51ms | HTTP有TCP握手开销 |
| 适用场景 | 本地进程 | 网络服务 | 各有优势 |

### 性能瓶颈

1. **TCP连接开销**：每次请求建立新连接
2. **HTTP协议解析**：请求/响应头解析开销
3. **JSON序列化**：与Stdio相同的JSON处理开销

## 优化建议

1. **连接池**：实现HTTP连接池复用TCP连接
2. **Keep-Alive**：启用HTTP Keep-Alive减少连接开销
3. **批量请求**：支持批量JSON-RPC请求
4. **HTTP/2**：升级到HTTP/2支持多路复用

## 结论

HTTP传输协议在本测试环境下表现：
- 50并发QPS：**663**
- 最低延迟：**1.51ms**
- 并发扩展性：**良好**

适用于需要网络访问的分布式场景，特别是：
- 跨机器通信
- 微服务架构
- Web集成场景
